<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Fracciones en el Caf√© San Juan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --color-bg: #f5f7fb;
      --color-surface: #ffffff;
      --color-header-gradient-1: #1d4ed8;
      --color-header-gradient-2: #22c55e;
      --color-primary: #2563eb;
      --color-primary-soft: #dbeafe;
      --color-accent: #22c55e;
      --color-text: #111827;
      --color-muted: #6b7280;
      --color-error: #dc2626;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 10px 25px rgba(15, 23, 42, 0.08);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #eff6ff, #f9fafb);
      color: var(--color-text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .app {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px;
      flex: 1 0 auto;
    }

    header {
      background: linear-gradient(135deg, var(--color-header-gradient-1), var(--color-header-gradient-2));
      color: #ffffff;
      border-radius: 24px;
      padding: 18px 24px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 18px 40px rgba(30, 64, 175, 0.35);
      gap: 12px;
    }

    header h1 {
      margin: 0;
      font-size: 1.35rem;
    }

    header p {
      margin: 4px 0 0;
      font-size: 0.9rem;
      opacity: 0.95;
    }

    .header-actions {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
    }

    .badge {
      font-size: 0.75rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255, 255, 255, 0.35);
    }

    .button-row {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .small-button {
      font-size: 0.8rem;
      padding: 5px 10px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: rgba(255, 255, 255, 0.9);
      color: #111827;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .small-button.secondary {
      background: rgba(15, 23, 42, 0.08);
      color: #0f172a;
    }

    .small-button:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .mark-button {
      background: #22c55e;
      color: #ffffff;
    }

    .mark-button:disabled {
      background: #16a34a;
      opacity: 0.7;
    }

    main {
      display: flex;
      gap: 16px;
      margin-top: 16px;
    }

    .sidebar {
      flex: 0 0 260px;
      background: var(--color-surface);
      border-radius: var(--radius-lg);
      padding: 16px;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .sidebar h2 {
      margin: 0 0 8px;
      font-size: 1rem;
    }

    .nav-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .nav-button {
      width: 100%;
      text-align: left;
      border: none;
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 0.88rem;
      cursor: pointer;
      background: transparent;
      color: var(--color-muted);
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background 0.2s, color 0.2s, transform 0.1s;
    }

    .nav-button span.icon {
      font-size: 1.1rem;
    }

    .nav-button:hover {
      background: #eff6ff;
      color: #1d4ed8;
      transform: translateY(-1px);
    }

    .nav-button.active {
      background: var(--color-primary);
      color: #ffffff;
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.45);
    }

    .nav-button.active span.icon {
      transform: scale(1.05);
    }

    .sidebar-footer {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px dashed #e5e7eb;
      font-size: 0.8rem;
      color: var(--color-muted);
    }

    .progress-container {
      margin-top: 8px;
    }

    .progress-label {
      font-size: 0.8rem;
      margin-bottom: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: var(--color-muted);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #22c55e, #16a34a, #4ade80);
      transition: width 0.3s ease-out;
    }

    .content {
      flex: 1;
      background: var(--color-surface);
      border-radius: var(--radius-lg);
      padding: 16px;
      box-shadow: var(--shadow-soft);
      min-height: 400px;
    }

    .section {
      display: none;
      animation: fadeIn 0.2s ease-out;
    }

    .section.visible {
      display: block;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 10px;
    }

    .section-header h2 {
      font-size: 1.1rem;
      margin: 0;
    }

    .section-header small {
      font-size: 0.8rem;
      color: var(--color-muted);
    }

    .card {
      background: #f9fafb;
      border-radius: var(--radius-md);
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid #e5e7eb;
    }

    .card.highlight {
      border-color: var(--color-primary);
      background: var(--color-primary-soft);
    }

    /* Estilos espec√≠ficos para los recursos del Nivel 0 */
    .resources-grid {
      display: grid;
      /* Ajustado para que las tarjetas sean m√°s anchas antes de saltar l√≠nea */
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 12px;
    }

    .resource-card {
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: var(--radius-md);
      padding: 14px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    }

    .resource-title {
      font-weight: 600;
      font-size: 1rem;
      color: var(--color-primary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .resource-embed-container {
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* Ratio 16:9 */
      background: #000;
      border-radius: 8px;
      overflow: hidden;
    }

    .resource-embed-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }
    
    .external-link-btn {
      display: inline-block;
      margin-top: 4px;
      padding: 6px 12px;
      background: #f3f4f6;
      color: #374151;
      text-decoration: none;
      border-radius: 6px;
      font-size: 0.85rem;
      text-align: center;
      transition: background 0.2s;
    }
    
    .external-link-btn:hover {
      background: #e5e7eb;
      color: #111827;
    }
    
    .key-idea {
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(37, 99, 235, 0.07);
      border-left: 4px solid var(--color-primary);
      font-size: 0.9rem;
    }

    .key-idea strong {
      display: block;
      margin-bottom: 2px;
    }

    .small-text {
      font-size: 0.8rem;
      color: var(--color-muted);
      margin-top: 3px;
    }

    .term {
      border-bottom: 1px dotted #9ca3af;
      cursor: help;
    }

    form {
      margin: 0;
    }

    .exercise {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px dashed #e5e7eb;
    }

    .options-group {
      display: flex;
      flex-direction: column;
      gap: 3px;
      font-size: 0.9rem;
    }

    .options-group label {
      cursor: pointer;
    }

    .primary-button {
      margin-top: 6px;
      border-radius: 999px;
      border: none;
      padding: 7px 14px;
      background: var(--color-primary);
      color: #ffffff;
      font-size: 0.85rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .primary-button:disabled {
      opacity: 0.65;
      cursor: default;
    }

    .feedback {
      margin-top: 6px;
      font-size: 0.85rem;
    }

    .text-success {
      color: var(--color-accent);
    }

    .text-error {
      color: var(--color-error);
    }

    .text-warning {
      color: #d97706;
    }

    .question {
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px dashed #e5e7eb;
    }

    #quizResult {
      margin-top: 8px;
      font-size: 0.9rem;
    }

    .form-row {
      margin-bottom: 8px;
      display: flex;
      flex-direction: column;
      gap: 2px;
      font-size: 0.9rem;
    }

    .form-row-inline {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
    }

    .form-row-inline > div {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 2px;
      font-size: 0.9rem;
    }

    input[type="text"] {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 0.9rem;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.25);
    }

    input[readonly] {
      background: #e5e7eb;
      cursor: default;
    }

    footer {
      flex-shrink: 0;
      text-align: center;
      font-size: 0.8rem;
      color: var(--color-muted);
      padding: 8px 4px 12px;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Modo lectura f√°cil */
    body.easy-reading .content {
      font-size: 1.02rem;
      line-height: 1.7;
    }

    body.easy-reading .card {
      box-shadow: none;
      background: #ffffff;
    }

    body.easy-reading .sidebar {
      box-shadow: none;
    }
    
    body.easy-reading .resource-card {
        box-shadow: none;
        border: 1px solid #000;
    }

    /* Modo oscuro */
    body.dark-theme {
      --color-bg: #020617;
      --color-surface: #020617;
      --color-header-gradient-1: #0f172a;
      --color-header-gradient-2: #059669;
      --color-primary: #38bdf8;
      --color-primary-soft: #0f172a;
      --color-accent: #22c55e;
      --color-text: #e5e7eb;
      --color-muted: #9ca3af;
      --color-error: #fb7185;
      --shadow-soft: 0 10px 25px rgba(15, 23, 42, 0.9);
    }

    body.dark-theme {
      background: radial-gradient(circle at top left, #020617, #020617);
    }

    body.dark-theme .sidebar,
    body.dark-theme .content {
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.9);
    }

    body.dark-theme .card, body.dark-theme .resource-card {
      background: #020617;
      border-color: #1f2937;
    }
    
    body.dark-theme .external-link-btn {
      background: #1f2937;
      color: #e5e7eb;
    }
    
    body.dark-theme .external-link-btn:hover {
      background: #374151;
    }

    body.dark-theme .card.highlight {
      background: #0b1120;
      border-color: #22c55e;
    }

    body.dark-theme .nav-button:hover {
      background: #0b1120;
      color: #e5e7eb;
    }

    body.dark-theme .nav-button.active {
      box-shadow: 0 8px 18px rgba(2, 132, 199, 0.8);
    }

    body.dark-theme .progress-bar {
      background: #0b1120;
    }

    body.dark-theme input[type="text"] {
      background: #020617;
      color: #e5e7eb;
      border-color: #374151;
    }

    body.dark-theme input[readonly] {
      background: #111827;
    }

    body.dark-theme .small-button.secondary {
      background: #0b1120;
      color: #e5e7eb;
    }

    /* Responsivo */
    @media (max-width: 900px) {
      main {
        flex-direction: column;
      }

      .sidebar {
        flex: none;
        order: 2;
      }

      .content {
        order: 1;
      }
    }

    @media (max-width: 600px) {
      header {
        padding: 14px 16px;
      }

      .sidebar {
        padding: 12px;
      }

      .content {
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <h1>Fracciones con Caf√© San Juan</h1>
        <p>Mini-plataforma para practicar fracciones usando situaciones reales del
          <strong>Proyecto Pedag√≥gico Productivo Caf√© San Juan</strong>.</p>
      </div>
      <div class="header-actions">
        <div class="badge">Pensado para grados 6.¬∫ a 9.¬∫ ¬∑ Nivelaci√≥n en fracciones</div>
        <div class="button-row">
          <button id="toggleTheme" class="small-button secondary" type="button">Tema: claro</button>
          <button id="toggleEasyMode" class="small-button secondary" type="button">Modo lectura f√°cil: apagado</button>
        </div>
      </div>
    </header>

    <main>
      <aside class="sidebar">
        <h2>Ruta de aprendizaje</h2>
        <ul class="nav-list">
          <li>
            <button class="nav-button active" data-section="intro">
              <span class="icon">üèÅ</span>
              <span>Inicio y datos</span>
            </button>
          </li>
          <li>
            <button class="nav-button" data-section="nivel0">
              <span class="icon">üß†</span>
              <span>Nivel 0 ¬∑ Conceptual</span>
            </button>
          </li>
          <li>
            <button class="nav-button" data-section="nivel1">
              <span class="icon">ü••</span>
              <span>Nivel 1 ¬∑ Recolecci√≥n</span>
            </button>
          </li>
          <li>
            <button class="nav-button" data-section="nivel2">
              <span class="icon">‚è±Ô∏è</span>
              <span>Nivel 2 ¬∑ Proceso y tiempo</span>
            </button>
          </li>
          <li>
            <button class="nav-button" data-section="nivel3">
              <span class="icon">‚òï</span>
              <span>Nivel 3 ¬∑ Barismo y recetas</span>
            </button>
          </li>
          <li>
            <button class="nav-button" data-section="glosario">
              <span class="icon">üìö</span>
              <span>Glosario cafetero</span>
            </button>
          </li>
          <li>
            <button class="nav-button" data-section="test">
              <span class="icon">üìù</span>
              <span>Test final</span>
            </button>
          </li>
        </ul>

        <div class="progress-container">
          <div class="progress-label">
            <span>Progreso general</span>
            <span id="progressPercent">0%</span>
          </div>
          <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-fill" id="progressFill"></div>
          </div>
        </div>

        <div class="sidebar-footer">
          <strong>Sugerencias de ruta:</strong>
          <ul style="padding-left: 18px; margin: 6px 0 0;">
            <li><strong>Ruta A (6.¬∫‚Äì7.¬∫):</strong> Inicio ‚Üí Niveles 1 y 2 ‚Üí Test (10 preguntas aleatorias).</li>
            <li><strong>Ruta B (8.¬∫‚Äì9.¬∫):</strong> Todos los niveles ‚Üí Test (10 preguntas aleatorias).</li>
          </ul>
          <p style="margin-top: 6px;">Puede ser usada por estudiantes, docentes u otras personas. Idealmente con acompa√±amiento docente.</p>
        </div>
      </aside>

      <section class="content">
        <section id="intro" class="section visible">
          <div class="section-header">
            <div>
              <h2>Inicio ¬∑ Datos de quien usa la app</h2>
              <small>Complete los datos para que aparezcan en el test final.</small>
            </div>
          </div>

          <div class="card highlight">
            <h3 style="margin-top: 0;">Datos b√°sicos</h3>
            <form id="studentForm">
              <div class="form-row">
                <label for="studentName">Nombre:</label>
                <input type="text" id="studentName" placeholder="Nombre de la persona que usa la app" />
              </div>
              <div class="form-row">
                <label for="studentRole">Rol:</label>
                <input type="text" id="studentRole" placeholder="Ej: Estudiante, Docente, Particular, Invitado..." />
              </div>
              <div class="form-row">
                <label for="studentGrade">Grado o grupo (o N/A):</label>
                <input type="text" id="studentGrade" placeholder="Ej: 6¬∞, 9¬∞, Docentes, Familia, N/A..." />
              </div>
              <div class="form-row-inline">
                <div>
                  <label for="studentDate">Fecha:</label>
                  <input type="text" id="studentDate" readonly />
                </div>
                <div>
                  <label for="studentTime">Hora:</label>
                  <input type="text" id="studentTime" readonly />
                </div>
              </div>
              <button class="primary-button" type="button" id="saveStudentData">üíæ Guardar datos</button>
            </form>
            <div id="studentFeedback" class="small-text"></div>
          </div>

          <div class="section-header">
            <div>
              <h2>¬øPara qu√© sirven las fracciones en el caf√©?</h2>
              <small>Lectura introductoria + idea clave + lectura en voz alta</small>
            </div>
            <button class="small-button" type="button" data-read="intro-text">üîä Leer en voz alta</button>
          </div>
          <div id="intro-text" class="card">
            <p>
              En el <strong>PPP Caf√© San Juan</strong> se toman decisiones todo el tiempo: cu√°nta
              <span class="term" title="Cantidad grande de caf√© que se usa como medida en el campo.">carga</span> de caf√© se recogi√≥,
              cu√°nto dura la fermentaci√≥n, cu√°ntas tazas se pueden preparar con un kilo de caf√©, etc.
            </p>
            <p>
              Muchas de esas decisiones se pueden expresar con <strong>fracciones</strong>: partes de un todo.
              Por ejemplo:
            </p>
            <ul>
              <li>Si se recoge <strong>media canasta</strong> de caf√©, eso es <strong>1/2</strong> canasta.</li>
              <li>Si se fermenta durante <strong>3/4 de hora</strong>, eso son <strong>3/4</strong> de una hora.</li>
              <li>Si se usa caf√© y agua en una receta 1:15, la fracci√≥n <strong>1/15</strong> compara caf√© con agua.</li>
            </ul>
            <div class="key-idea">
              <strong>Idea clave de este m√≥dulo</strong>
              En esta app las fracciones aparecen siempre dentro de una historia de caf√©:
              recolecci√≥n, transformaci√≥n y preparaci√≥n de la bebida. La meta es pasar de ver
              fracciones como algo "raro" a verlas como una herramienta para tomar decisiones.
            </div>
          </div>
        </section>

        <section id="nivel0" class="section">
          <div class="section-header">
            <div>
              <h2>Nivel 0 ¬∑ Conceptual</h2>
              <small>Recursos multimedia para reforzar bases te√≥ricas.</small>
            </div>
          </div>

          <div class="card">
            <p>Antes de empezar con las actividades pr√°cticas de la finca, es importante tener claros algunos conceptos fundamentales. Explora estos recursos en el orden sugerido:</p>
            
            <div class="resources-grid">
              
              <div class="resource-card">
                <div class="resource-title">
                  <span>üé• Video Explicativo</span>
                </div>
                <div class="resource-embed-container">
                  <iframe src="https://www.youtube.com/embed/yU_Jg30TnJo" title="Video Conceptual" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                </div>
                <a href="https://www.youtube.com/watch?v=yU_Jg30TnJo" target="_blank" class="external-link-btn">
                  üì∫ Ver en YouTube (Pantalla completa) ‚Üó
                </a>
                <p class="small-text">Introducci√≥n visual a los conceptos que usaremos en el campo.</p>
              </div>

              <div class="resource-card">
                <div class="resource-title">
                  <span>üéß Audio Gu√≠a</span>
                </div>
                <div class="resource-embed-container">
                  <iframe src="https://drive.google.com/file/d/1OWchN7zXxV5SmNJtRpa0sPkRJJdDt8fh/preview" title="Audio Explicativo" allowfullscreen></iframe>
                </div>
                 <a href="https://drive.google.com/file/d/1OWchN7zXxV5SmNJtRpa0sPkRJJdDt8fh/view?usp=sharing" target="_blank" class="external-link-btn">
                  üîä Abrir archivo de audio aparte ‚Üó
                </a>
                <p class="small-text">Escucha la explicaci√≥n detallada sobre el uso de fracciones.</p>
              </div>

              <div class="resource-card">
                <div class="resource-title">
                  <span>üìä Diapositivas de Apoyo</span>
                </div>
                <div class="resource-embed-container">
                   <iframe src="https://drive.google.com/file/d/1V-MzbwVlosZP0xpzb4IxO2AVi4CLkL6Q/preview" title="Diapositivas" allowfullscreen></iframe>
                </div>
                 <a href="https://drive.google.com/file/d/1V-MzbwVlosZP0xpzb4IxO2AVi4CLkL6Q/view?usp=sharing" target="_blank" class="external-link-btn">
                  üìÑ Abrir PDF en pantalla completa ‚Üó
                </a>
                <p class="small-text">Material gr√°fico de soporte para repasar en cualquier momento.</p>
              </div>

            </div>

            <button class="small-button mark-button" style="margin-top: 20px;" type="button" data-mark-level="nivel0">
              ‚úÖ Marcar nivel 0 como completado
            </button>
          </div>
        </section>

        <section id="nivel1" class="section">
          <div class="section-header">
            <div>
              <h2>Nivel 1 ¬∑ Recolecci√≥n y fracciones mayores que 1</h2>
              <small>Interpretar fracciones como mitades y cuartos de canasta.</small>
            </div>
            <button class="small-button" type="button" data-read="nivel1-text">üîä Leer en voz alta</button>
          </div>

          <div id="nivel1-text" class="card">
            <p>
              Imaginemos que una <strong>unidad</strong> es una canasta llena de caf√© cereza. Si se parte la canasta
              en 2 partes iguales, cada parte es <strong>1/2</strong>. Si se parte en 4 partes iguales, cada parte es <strong>1/4</strong>.
            </p>
            <p>
              A veces, en el campo se habla de ‚Äúcanasta y media‚Äù o ‚Äúdos canastas y cuarto‚Äù. En matem√°ticas, estas
              cantidades se pueden escribir como <strong>fracciones impropias</strong> (mayores que 1). Por ejemplo:
            </p>
            <ul>
              <li>Una canasta y media = <strong>1 1/2</strong> = <strong>3/2</strong> (tres mitades).</li>
              <li>Dos canastas y media = <strong>2 1/2</strong> = <strong>5/2</strong> (cinco mitades).</li>
              <li>Una canasta y cuarto = <strong>1 1/4</strong> = <strong>5/4</strong> (cinco cuartos).</li>
            </ul>
            <div class="key-idea">
              <strong>Idea clave de este nivel</strong>
              El n√∫mero de arriba (numerador) dice cu√°ntas partes se toman. El n√∫mero de abajo (denominador) dice
              en cu√°ntas partes iguales se parti√≥ la unidad. Si el numerador es mayor que el denominador, la fracci√≥n
              es <strong>mayor que 1</strong>.
            </div>
          </div>

          <div class="card exercise">
            <h3 style="margin-top: 0;">Mini-ejercicios ¬∑ ¬øSe entiende la idea?</h3>

            <form id="nivel1-ex1">
              <p><strong>1.</strong> En el beneficiadero se representan las canastas de caf√© con la fracci√≥n 3/2.
                ¬øQu√© significa 3/2?</p>
              <div class="options-group">
                <label><input type="radio" name="n1q1" value="a" /> Tres canastas llenas.</label>
                <label><input type="radio" name="n1q1" value="b" /> Tres mitades de canasta, es decir menos de una canasta.</label>
                <label><input type="radio" name="n1q1" value="c" /> Tres mitades de canasta, es decir una canasta y media.</label>
                <label><input type="radio" name="n1q1" value="d" /> Media canasta.</label>
              </div>
              <button class="primary-button" type="button" id="btn-n1-ex1">
                ‚úÖ Revisar respuesta
              </button>
              <div class="feedback" id="n1ex1Feedback"></div>
            </form>

            <form id="nivel1-ex2" style="margin-top: 10px;">
              <p><strong>2.</strong> Escribe con n√∫meros la frase: ‚Äúdos canastas y media de caf√©‚Äù.</p>
              <div class="options-group">
                <label><input type="radio" name="n1q2" value="a" /> 3/2</label>
                <label><input type="radio" name="n1q2" value="b" /> 5/2</label>
                <label><input type="radio" name="n1q2" value="c" /> 2/5</label>
                <label><input type="radio" name="n1q2" value="d" /> 1/2</label>
              </div>
              <button class="primary-button" type="button" id="btn-n1-ex2">
                ‚úÖ Revisar respuesta
              </button>
              <div class="feedback" id="n1ex2Feedback"></div>
            </form>

            <button class="small-button mark-button" style="margin-top: 10px;" type="button" data-mark-level="nivel1">
              ‚úÖ Marcar nivel 1 como completado
            </button>
            <p class="small-text">
              Si hay dificultad, se pueden dibujar canastas divididas en mitades en el tablero y volver a intentarlo.
            </p>
          </div>
        </section>

        <section id="nivel2" class="section">
          <div class="section-header">
            <div>
              <h2>Nivel 2 ¬∑ Proceso y fracciones de tiempo</h2>
              <small>Relacionar fracciones con minutos en el secado y la fermentaci√≥n.</small>
            </div>
            <button class="small-button" type="button" data-read="nivel2-text">üîä Leer en voz alta</button>
          </div>

          <div id="nivel2-text" class="card">
            <p>
              En el procesamiento del caf√© se controla mucho el <strong>tiempo</strong>: cu√°nto dura la fermentaci√≥n,
              cada cu√°nto se mueve el caf√© en la marquesina, cada cu√°nto se toma la temperatura, etc.
            </p>
            <p>
              Una hora tiene <strong>60 minutos</strong>. Algunas fracciones importantes de la hora son:
            </p>
            <ul>
              <li><strong>1/2 de hora</strong> = 30 minutos.</li>
              <li><strong>1/4 de hora</strong> = 15 minutos.</li>
              <li><strong>3/4 de hora</strong> = 45 minutos.</li>
            </ul>
            <div class="key-idea">
              <strong>Idea clave de este nivel</strong>
              Para pasar de una fracci√≥n de hora a minutos se multiplica la fracci√≥n por 60.
              Por ejemplo: 3/4 de hora = 3/4 √ó 60 = 45 minutos.
            </div>
          </div>

          <div class="card exercise">
            <h3 style="margin-top: 0;">Mini-ejercicios ¬∑ Tiempo en el proceso</h3>

            <form id="nivel2-ex1">
              <p><strong>1.</strong> Durante el secado se revisa el caf√© cada 1/2 hora. ¬øCu√°ntos minutos son 1/2 hora?</p>
              <div class="options-group">
                <label><input type="radio" name="n2q1" value="a" /> 15 minutos</label>
                <label><input type="radio" name="n2q1" value="b" /> 30 minutos</label>
                <label><input type="radio" name="n2q1" value="c" /> 45 minutos</label>
                <label><input type="radio" name="n2q1" value="d" /> 60 minutos</label>
              </div>
              <button class="primary-button" type="button" id="btn-n2-ex1">
                ‚úÖ Revisar respuesta
              </button>
              <div class="feedback" id="n2ex1Feedback"></div>
            </form>

            <form id="nivel2-ex2" style="margin-top: 10px;">
              <p><strong>2.</strong> En el laboratorio se comparan dos opciones para revisar la fermentaci√≥n:
                cada 1/2 de hora o cada 3/4 de hora. ¬øQu√© cantidad de tiempo es mayor?</p>
              <div class="options-group">
                <label><input type="radio" name="n2q2" value="a" /> 1/2 de hora</label>
                <label><input type="radio" name="n2q2" value="b" /> 3/4 de hora</label>
                <label><input type="radio" name="n2q2" value="c" /> Son iguales</label>
                <label><input type="radio" name="n2q2" value="d" /> No se puede saber</label>
              </div>
              <button class="primary-button" type="button" id="btn-n2-ex2">
                ‚úÖ Revisar respuesta
              </button>
              <div class="feedback" id="n2ex2Feedback"></div>
            </form>

            <button class="small-button mark-button" style="margin-top: 10px;" type="button" data-mark-level="nivel2">
              ‚úÖ Marcar nivel 2 como completado
            </button>
            <p class="small-text">
              Se puede pedir que expliquen por qu√© 3/4 de hora es m√°s que 1/2 usando dibujos o l√≠neas de tiempo.
            </p>
          </div>
        </section>

        <section id="nivel3" class="section">
          <div class="section-header">
            <div>
              <h2>Nivel 3 ¬∑ Barismo, recetas y razones</h2>
              <small>Usar fracciones para comparar caf√© y agua en una preparaci√≥n.</small>
            </div>
            <button class="small-button" type="button" data-read="nivel3-text">üîä Leer en voz alta</button>
          </div>

          <div id="nivel3-text" class="card">
            <p>
              En el laboratorio de caf√© se preparan bebidas con diferentes <strong>recetas</strong>. Una
              receta puede decir, por ejemplo:
            </p>
            <ul>
              <li><strong>20 g de caf√©</strong> por <strong>300 g de agua</strong>.</li>
              <li><strong>18 g de caf√©</strong> por <strong>270 g de agua</strong>.</li>
            </ul>
            <p>
              Si se compara ‚Äúcaf√© sobre agua‚Äù se puede escribir la fracci√≥n
              <strong>caf√© / agua</strong>. Por ejemplo:
            </p>
            <ul>
              <li>20/300 = 1/15 ‚Üí fracci√≥n <strong>menor que 1</strong>.</li>
              <li>18/270 = 1/15 ‚Üí fracci√≥n <strong>menor que 1</strong> (la misma proporci√≥n).</li>
            </ul>
            <div class="key-idea">
              <strong>Idea clave de este nivel</strong>
              Una fracci√≥n tambi√©n puede comparar dos cantidades diferentes (caf√© y agua, tazas y kilos, etc.).
              Si la fracci√≥n es menor que 1, el numerador es m√°s peque√±o que el denominador.
            </div>
          </div>

          <div class="card exercise">
            <h3 style="margin-top: 0;">Mini-ejercicios ¬∑ Recetas de caf√©</h3>

            <form id="nivel3-ex1">
              <p><strong>1.</strong> En una receta se usan 20 g de caf√© y 300 g de agua. ¬øQu√© tipo de fracci√≥n es 20/300?</p>
              <div class="options-group">
                <label><input type="radio" name="n3q1" value="a" /> Mayor que 1</label>
                <label><input type="radio" name="n3q1" value="b" /> Menor que 1</label>
                <label><input type="radio" name="n3q1" value="c" /> Igual a 1</label>
                <label><input type="radio" name="n3q1" value="d" /> No es una fracci√≥n</label>
              </div>
              <button class="primary-button" type="button" id="btn-n3-ex1">
                ‚úÖ Revisar respuesta
              </button>
              <div class="feedback" id="n3ex1Feedback"></div>
            </form>

            <form id="nivel3-ex2" style="margin-top: 10px;">
              <p><strong>2.</strong> Un kilo de caf√© tostado se reparte en 4 bolsas iguales para vender en la instituci√≥n.
                ¬øQu√© fracci√≥n de kilo hay en cada bolsa?</p>
              <div class="options-group">
                <label><input type="radio" name="n3q2" value="a" /> 1/2</label>
                <label><input type="radio" name="n3q2" value="b" /> 1/3</label>
                <label><input type="radio" name="n3q2" value="c" /> 1/4</label>
                <label><input type="radio" name="n3q2" value="d" /> 1/5</label>
              </div>
              <button class="primary-button" type="button" id="btn-n3-ex2">
                ‚úÖ Revisar respuesta
              </button>
              <div class="feedback" id="n3ex2Feedback"></div>
            </form>

            <button class="small-button mark-button" style="margin-top: 10px;" type="button" data-mark-level="nivel3">
              ‚úÖ Marcar nivel 3 como completado
            </button>
            <p class="small-text">
              Pueden inventar una receta propia y escribir la fracci√≥n caf√©/agua correspondiente.
            </p>
          </div>
        </section>

        <section id="glosario" class="section">
          <div class="section-header">
            <div>
              <h2>Glosario cafetero y matem√°tico</h2>
              <small>Para que ning√∫n t√©rmino se convierta en obst√°culo.</small>
            </div>
          </div>

          <div class="card">
            <ul>
              <li><strong>Carga:</strong> medida grande de caf√© que se usa en el campo. Puede cambiar seg√∫n la regi√≥n.
                En esta app se usa solo como ‚Äúuna unidad grande de caf√©‚Äù.</li>
              <li><strong>Canasta:</strong> recipiente donde se recoge caf√© cereza. Tambi√©n se usa como ‚Äúunidad‚Äù de medida.</li>
              <li><strong>Beneficiadero:</strong> lugar donde se realiza el proceso de despulpado, fermentaci√≥n, lavado
                y secado del caf√©.</li>
              <li><strong>Fracci√≥n:</strong> forma de escribir una parte de un todo o la comparaci√≥n entre dos cantidades.
                Tiene numerador (arriba) y denominador (abajo).</li>
              <li><strong>Fracci√≥n impropia:</strong> fracci√≥n donde el numerador es mayor que el denominador. Representa
                una cantidad mayor que 1 unidad.</li>
              <li><strong>Raz√≥n:</strong> comparaci√≥n entre dos cantidades. Una fracci√≥n puede representar una raz√≥n.</li>
              <li><strong>Hora / minuto:</strong> 1 hora = 60 minutos. Las fracciones de hora se convierten a
                minutos multiplicando por 60.</li>
            </ul>
          </div>
        </section>

        <section id="test" class="section">
          <div class="section-header">
            <div>
              <h2>Test final ¬∑ Fracciones en el Caf√© San Juan</h2>
              <small>Banco de 28 preguntas. Se muestran 10 al azar en cada intento.</small>
            </div>
          </div>

          <div class="card highlight" id="studentSummaryCard">
            <h3 style="margin-top: 0;">Datos del intento</h3>
            <p class="small-text">Tomados de la pantalla de inicio.</p>
            <p><strong>Nombre:</strong> <span id="summaryName">No registrado</span></p>
            <p><strong>Rol:</strong> <span id="summaryRole">No registrado</span></p>
            <p><strong>Grado/Grupo:</strong> <span id="summaryGrade">No registrado</span></p>
            <p><strong>Fecha y hora de registro:</strong> <span id="summaryDateTime">No registrado</span></p>
            <p class="small-text">
              <strong>Tiempo transcurrido en este test:</strong>
              <span id="timerDisplay">00:00</span>
            </p>
          </div>

          <div class="card">
            <p class="small-text">
              Recomendaci√≥n: primero responder sin calculadora, luego comparar con un compa√±ero y al final leer
              las explicaciones. El tiempo no es para competir, sino para notar si mejora su velocidad de an√°lisis.
            </p>
          </div>

          <div class="card">
            <form id="quizForm">
              <div class="question" data-qid="q1">
                <p><strong>1.</strong> En el beneficiadero se llenan canastas con caf√© cereza. Si una canasta llena es 1 unidad,
                  ¬øqu√© representa la fracci√≥n 3/2?</p>
                <div class="options-group">
                  <label><input type="radio" name="q1" value="a" /> Tres canastas llenas.</label>
                  <label><input type="radio" name="q1" value="b" /> Tres mitades de canasta, es decir menos de una canasta.</label>
                  <label><input type="radio" name="q1" value="c" /> Tres mitades de canasta, es decir una canasta y media.</label>
                  <label><input type="radio" name="q1" value="d" /> Media canasta.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q1"></div>
              </div>

              <div class="question" data-qid="q2">
                <p><strong>2.</strong> ¬øQu√© fracci√≥n representa mejor la frase ‚Äúdos canastas y media de caf√©‚Äù?</p>
                <div class="options-group">
                  <label><input type="radio" name="q2" value="a" /> 3/2</label>
                  <label><input type="radio" name="q2" value="b" /> 5/2</label>
                  <label><input type="radio" name="q2" value="c" /> 2/5</label>
                  <label><input type="radio" name="q2" value="d" /> 1/2</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q2"></div>
              </div>

              <div class="question" data-qid="q3">
                <p><strong>3.</strong> Durante la fermentaci√≥n se revisa el tanque cada 3/4 de hora.
                  ¬øCu√°ntos minutos son 3/4 de hora?</p>
                <div class="options-group">
                  <label><input type="radio" name="q3" value="a" /> 15 minutos</label>
                  <label><input type="radio" name="q3" value="b" /> 30 minutos</label>
                  <label><input type="radio" name="q3" value="c" /> 45 minutos</label>
                  <label><input type="radio" name="q3" value="d" /> 90 minutos</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q3"></div>
              </div>

              <div class="question" data-qid="q4">
                <p><strong>4.</strong> En el secado, el grupo A revisa el caf√© cada 1/2 hora y el grupo B cada 1/4 de hora.
                  ¬øCu√°l grupo revisa con m√°s frecuencia?</p>
                <div class="options-group">
                  <label><input type="radio" name="q4" value="a" /> Grupo A</label>
                  <label><input type="radio" name="q4" value="b" /> Grupo B</label>
                  <label><input type="radio" name="q4" value="c" /> Revisan con la misma frecuencia</label>
                  <label><input type="radio" name="q4" value="d" /> No se puede saber</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q4"></div>
              </div>

              <div class="question" data-qid="q5">
                <p><strong>5.</strong> Una receta de filtrado usa 20 g de caf√© por 300 g de agua. La fracci√≥n caf√©/agua es 20/300.
                  ¬øQu√© tipo de fracci√≥n es?</p>
                <div class="options-group">
                  <label><input type="radio" name="q5" value="a" /> Fracci√≥n mayor que 1</label>
                  <label><input type="radio" name="q5" value="b" /> Fracci√≥n menor que 1</label>
                  <label><input type="radio" name="q5" value="c" /> Fracci√≥n igual a 1</label>
                  <label><input type="radio" name="q5" value="d" /> No es una fracci√≥n</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q5"></div>
              </div>

              <div class="question" data-qid="q6">
                <p><strong>6.</strong> En un taller de barismo se reparte 1 kg de caf√© tostado en 4 bolsas iguales.
                  ¬øQu√© fracci√≥n de kilo recibe cada bolsa?</p>
                <div class="options-group">
                  <label><input type="radio" name="q6" value="a" /> 1/2</label>
                  <label><input type="radio" name="q6" value="b" /> 1/3</label>
                  <label><input type="radio" name="q6" value="c" /> 1/4</label>
                  <label><input type="radio" name="q6" value="d" /> 1/5</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q6"></div>
              </div>

              <div class="question" data-qid="q7">
                <p><strong>7.</strong> En una jornada se llena 1 1/2 carga de caf√©. ¬øC√≥mo se escribir√≠a esa cantidad como
                  fracci√≥n impropia?</p>
                <div class="options-group">
                  <label><input type="radio" name="q7" value="a" /> 1/2</label>
                  <label><input type="radio" name="q7" value="b" /> 2/1</label>
                  <label><input type="radio" name="q7" value="c" /> 3/2</label>
                  <label><input type="radio" name="q7" value="d" /> 5/2</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q7"></div>
              </div>

              <div class="question" data-qid="q8">
                <p><strong>8.</strong> En la fracci√≥n 3/4, ¬øqu√© indica el n√∫mero 4?</p>
                <div class="options-group">
                  <label><input type="radio" name="q8" value="a" /> Las partes que se toman.</label>
                  <label><input type="radio" name="q8" value="b" /> Las partes iguales en que se dividi√≥ la unidad.</label>
                  <label><input type="radio" name="q8" value="c" /> El n√∫mero de cargas de caf√© recogidas.</label>
                  <label><input type="radio" name="q8" value="d" /> Los minutos que dura una hora.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q8"></div>
              </div>

              <div class="question" data-qid="q9">
                <p><strong>9.</strong> En otra jornada se recogieron 7/4 canastas de caf√©. ¬øCu√°l frase describe mejor esa cantidad?</p>
                <div class="options-group">
                  <label><input type="radio" name="q9" value="a" /> Una canasta y cuarto.</label>
                  <label><input type="radio" name="q9" value="b" /> Una canasta y tres cuartos.</label>
                  <label><input type="radio" name="q9" value="c" /> Dos canastas completas.</label>
                  <label><input type="radio" name="q9" value="d" /> Tres cuartos de canasta.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q9"></div>
              </div>

              <div class="question" data-qid="q10">
                <p><strong>10.</strong> ¬øQu√© fracci√≥n impropia representa ‚Äútres canastas y un cuarto‚Äù de caf√© cereza?</p>
                <div class="options-group">
                  <label><input type="radio" name="q10" value="a" /> 7/4</label>
                  <label><input type="radio" name="q10" value="b" /> 9/4</label>
                  <label><input type="radio" name="q10" value="c" /> 13/4</label>
                  <label><input type="radio" name="q10" value="d" /> 3/4</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q10"></div>
              </div>

              <div class="question" data-qid="q11">
                <p><strong>11.</strong> En el pesaje se comparan 5/4 y 3/2 canastas. ¬øQu√© fracci√≥n representa mayor cantidad de caf√©?</p>
                <div class="options-group">
                  <label><input type="radio" name="q11" value="a" /> 5/4</label>
                  <label><input type="radio" name="q11" value="b" /> 3/2</label>
                  <label><input type="radio" name="q11" value="c" /> Son iguales.</label>
                  <label><input type="radio" name="q11" value="d" /> 1/4</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q11"></div>
              </div>

              <div class="question" data-qid="q12">
                <p><strong>12.</strong> La fermentaci√≥n de un lote dura 1 1/2 horas. ¬øCu√°ntos minutos dura en total?</p>
                <div class="options-group">
                  <label><input type="radio" name="q12" value="a" /> 45 minutos</label>
                  <label><input type="radio" name="q12" value="b" /> 60 minutos</label>
                  <label><input type="radio" name="q12" value="c" /> 75 minutos</label>
                  <label><input type="radio" name="q12" value="d" /> 90 minutos</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q12"></div>
              </div>

              <div class="question" data-qid="q13">
                <p><strong>13.</strong> En otra prueba se revisa el caf√© cada 1/3 de hora. ¬øCu√°ntos minutos son 1/3 de hora?</p>
                <div class="options-group">
                  <label><input type="radio" name="q13" value="a" /> 10 minutos</label>
                  <label><input type="radio" name="q13" value="b" /> 15 minutos</label>
                  <label><input type="radio" name="q13" value="c" /> 20 minutos</label>
                  <label><input type="radio" name="q13" value="d" /> 30 minutos</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q13"></div>
              </div>

              <div class="question" data-qid="q14">
                <p><strong>14.</strong> ¬øQu√© es m√°s largo: 2/3 de hora o 3/5 de hora?</p>
                <div class="options-group">
                  <label><input type="radio" name="q14" value="a" /> 2/3 de hora.</label>
                  <label><input type="radio" name="q14" value="b" /> 3/5 de hora.</label>
                  <label><input type="radio" name="q14" value="c" /> Son iguales.</label>
                  <label><input type="radio" name="q14" value="d" /> Depende de la temperatura.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q14"></div>
              </div>

              <div class="question" data-qid="q15">
                <p><strong>15.</strong> Se comparan dos recetas: A) 18 g de caf√© por 270 g de agua, B) 22 g de caf√© por 330 g de agua.
                  ¬øQu√© se puede decir de las fracciones caf√©/agua 18/270 y 22/330?</p>
                <div class="options-group">
                  <label><input type="radio" name="q15" value="a" /> La receta A es m√°s concentrada.</label>
                  <label><input type="radio" name="q15" value="b" /> La receta B es m√°s concentrada.</label>
                  <label><input type="radio" name="q15" value="c" /> Las dos tienen la misma proporci√≥n.</label>
                  <label><input type="radio" name="q15" value="d" /> Ninguna forma una fracci√≥n.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q15"></div>
              </div>

              <div class="question" data-qid="q16">
                <p><strong>16.</strong> ¬øEn cu√°l receta la fracci√≥n caf√©/agua es mayor (m√°s concentrada)?</p>
                <div class="options-group">
                  <label><input type="radio" name="q16" value="a" /> Receta A: 18 g de caf√© por 300 g de agua.</label>
                  <label><input type="radio" name="q16" value="b" /> Receta B: 25 g de caf√© por 300 g de agua.</label>
                  <label><input type="radio" name="q16" value="c" /> Receta C: 15 g de caf√© por 300 g de agua.</label>
                  <label><input type="radio" name="q16" value="d" /> Receta D: 10 g de caf√© por 300 g de agua.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q16"></div>
              </div>

              <div class="question" data-qid="q17">
                <p><strong>17.</strong> Para una degustaci√≥n se usan 3 bolsas de 1/4 de kilo de caf√© tostado. ¬øCu√°ntos kilos se usan en total?</p>
                <div class="options-group">
                  <label><input type="radio" name="q17" value="a" /> 1/2 kg</label>
                  <label><input type="radio" name="q17" value="b" /> 3/4 kg</label>
                  <label><input type="radio" name="q17" value="c" /> 1 kg</label>
                  <label><input type="radio" name="q17" value="d" /> 4/3 kg</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q17"></div>
              </div>

              <div class="question" data-qid="q18">
                <p><strong>18.</strong> Un kilo de caf√© se reparte en 5 bolsas iguales para vender en la tienda escolar.
                  ¬øQu√© fracci√≥n de kilo hay en cada bolsa?</p>
                <div class="options-group">
                  <label><input type="radio" name="q18" value="a" /> 1/2</label>
                  <label><input type="radio" name="q18" value="b" /> 1/3</label>
                  <label><input type="radio" name="q18" value="c" /> 1/4</label>
                  <label><input type="radio" name="q18" value="d" /> 1/5</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q18"></div>
              </div>

              <div class="question" data-qid="q19">
                <p><strong>19.</strong> Cada bolsa de caf√© pesa 1/2 kg. ¬øCu√°ntas bolsas se necesitan para completar 2 kg?</p>
                <div class="options-group">
                  <label><input type="radio" name="q19" value="a" /> 2 bolsas</label>
                  <label><input type="radio" name="q19" value="b" /> 3 bolsas</label>
                  <label><input type="radio" name="q19" value="c" /> 4 bolsas</label>
                  <label><input type="radio" name="q19" value="d" /> 5 bolsas</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q19"></div>
              </div>

              <div class="question" data-qid="q20">
                <p><strong>20.</strong> En un d√≠a de cosecha se completan 2 1/4 cargas de caf√©. ¬øC√≥mo se escribe esta cantidad
                  como fracci√≥n impropia?</p>
                <div class="options-group">
                  <label><input type="radio" name="q20" value="a" /> 5/4</label>
                  <label><input type="radio" name="q20" value="b" /> 7/4</label>
                  <label><input type="radio" name="q20" value="c" /> 9/4</label>
                  <label><input type="radio" name="q20" value="d" /> 11/4</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q20"></div>
              </div>

              <div class="question" data-qid="q21">
                <p><strong>21.</strong> ¬øCu√°l fracci√≥n es equivalente a 1/2?</p>
                <div class="options-group">
                  <label><input type="radio" name="q21" value="a" /> 1/4</label>
                  <label><input type="radio" name="q21" value="b" /> 2/6</label>
                  <label><input type="radio" name="q21" value="c" /> 2/4</label>
                  <label><input type="radio" name="q21" value="d" /> 3/8</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q21"></div>
              </div>

              <div class="question" data-qid="q22">
                <p><strong>22.</strong> Se tienen las fracciones 1/4, 1/2 y 3/4. Si se ordenan de menor a mayor,
                  ¬øcu√°l queda en la mitad?</p>
                <div class="options-group">
                  <label><input type="radio" name="q22" value="a" /> 1/4</label>
                  <label><input type="radio" name="q22" value="b" /> 1/2</label>
                  <label><input type="radio" name="q22" value="c" /> 3/4</label>
                  <label><input type="radio" name="q22" value="d" /> Son iguales.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q22"></div>
              </div>

              <div class="question" data-qid="q23">
                <p><strong>23.</strong> En la preparaci√≥n de 20 tazas de caf√©, ya se sirvieron 10 tazas.
                  ¬øQu√© fracci√≥n de las tazas planificadas se ha servido?</p>
                <div class="options-group">
                  <label><input type="radio" name="q23" value="a" /> 1/4</label>
                  <label><input type="radio" name="q23" value="b" /> 1/2</label>
                  <label><input type="radio" name="q23" value="c" /> 3/4</label>
                  <label><input type="radio" name="q23" value="d" /> 2/3</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q23"></div>
              </div>

              <div class="question" data-qid="q24">
                <p><strong>24.</strong> En la fracci√≥n 5/6, que representa la parte de caf√© defectuoso en un lote,
                  ¬øqu√© indica el n√∫mero 5?</p>
                <div class="options-group">
                  <label><input type="radio" name="q24" value="a" /> Las partes que se toman.</label>
                  <label><input type="radio" name="q24" value="b" /> Las partes iguales en que se dividi√≥ la unidad.</label>
                  <label><input type="radio" name="q24" value="c" /> La cantidad total de caf√©.</label>
                  <label><input type="radio" name="q24" value="d" /> El n√∫mero de tazas servidas.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q24"></div>
              </div>

              <div class="question" data-qid="q25">
                <p><strong>25.</strong> Se mezcla caf√© de dos fincas. 1/3 del lote es de la Finca A y el resto de la Finca B.
                  ¬øQu√© fracci√≥n representa la parte de la Finca B?</p>
                <div class="options-group">
                  <label><input type="radio" name="q25" value="a" /> 1/3</label>
                  <label><input type="radio" name="q25" value="b" /> 2/3</label>
                  <label><input type="radio" name="q25" value="c" /> 3/3</label>
                  <label><input type="radio" name="q25" value="d" /> 1/2</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q25"></div>
              </div>

              <div class="question" data-qid="q26">
                <p><strong>26.</strong> En un gr√°fico de humedad se comparan 1/5 y 1/4. ¬øCu√°l fracci√≥n es mayor?</p>
                <div class="options-group">
                  <label><input type="radio" name="q26" value="a" /> 1/5</label>
                  <label><input type="radio" name="q26" value="b" /> 1/4</label>
                  <label><input type="radio" name="q26" value="c" /> Son iguales.</label>
                  <label><input type="radio" name="q26" value="d" /> No se puede saber.</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q26"></div>
              </div>

              <div class="question" data-qid="q27">
                <p><strong>27.</strong> Si 2/4 de una canasta est√°n llenos de caf√©, ¬øqu√© fracci√≥n simplificada representa la parte llena?</p>
                <div class="options-group">
                  <label><input type="radio" name="q27" value="a" /> 1/4</label>
                  <label><input type="radio" name="q27" value="b" /> 1/2</label>
                  <label><input type="radio" name="q27" value="c" /> 2/4</label>
                  <label><input type="radio" name="q27" value="d" /> 3/4</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q27"></div>
              </div>

              <div class="question" data-qid="q28">
                <p><strong>28.</strong> En el laboratorio se registra que se humedeci√≥ 3/4 del lecho de secado.
                  ¬øQu√© n√∫mero decimal corresponde a 3/4?</p>
                <div class="options-group">
                  <label><input type="radio" name="q28" value="a" /> 0,25</label>
                  <label><input type="radio" name="q28" value="b" /> 0,33</label>
                  <label><input type="radio" name="q28" value="c" /> 0,50</label>
                  <label><input type="radio" name="q28" value="d" /> 0,75</label>
                </div>
                <div class="quiz-feedback feedback" id="feedback-q28"></div>
              </div>

              <button class="primary-button" type="button" id="submitQuiz">
                üì§ Enviar respuestas y ver explicaciones
              </button>
            </form>

            <div id="quizResult"></div>
            <div id="sheetFeedback" class="small-text" style="margin-top: 10px;"></div>

            <button class="small-button mark-button" style="margin-top: 10px;" type="button" data-mark-level="test">
              ‚úÖ Marcar test como completado
            </button>
          </div>
        </section>
      </section>
    </main>
  </div>

  <footer>
    Creado por Alejandro Mart√≠nez Caicedo
  </footer>

  <script>
    // **********************************************
    // CONFIGURACI√ìN DE GOOGLE SHEETS
    // **********************************************
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwRyda-qaq0MkSoVLR4khhuQ62rJ0CYaVbdPA7xEyC0ruoV_SJrmcGHSU-la8ZFM1rd/exec";

    // Estado global
    const completedLevels = { nivel0: false, nivel1: false, nivel2: false, nivel3: false, test: false };
    const miniExerciseState = {
      nivel1: { ex1: false, ex2: false },
      nivel2: { ex1: false, ex2: false },
      nivel3: { ex1: false, ex2: false }
    };
    const studentData = { nombre: '', rol: '', grado: '', fechaHora: '' };
    let activeQuestionIds = [];
    let testTimerSeconds = 0;
    let testTimerInterval = null;
    let testTimerStarted = false;

    function updateProgressBar() {
      const fill = document.getElementById('progressFill');
      const percentLabel = document.getElementById('progressPercent');
      const total = Object.keys(completedLevels).length;
      const done = Object.values(completedLevels).filter(Boolean).length;
      const percent = Math.round((done / total) * 100);
      fill.style.width = percent + '%';
      fill.setAttribute('aria-valuenow', percent.toString());
      percentLabel.textContent = percent + '%';
    }

    function canCompleteLevel(level) {
      if (level === 'nivel1' || level === 'nivel2' || level === 'nivel3') {
        const st = miniExerciseState[level];
        return st.ex1 && st.ex2;
      }
      return true;
    }

    function updateStudentSummary() {
      const nameSpan = document.getElementById('summaryName');
      const roleSpan = document.getElementById('summaryRole');
      const gradeSpan = document.getElementById('summaryGrade');
      const dateSpan = document.getElementById('summaryDateTime');
      if (!nameSpan) return;
      nameSpan.textContent = studentData.nombre || 'No registrado';
      roleSpan.textContent = studentData.rol || 'No registrado';
      gradeSpan.textContent = studentData.grado || 'No registrado';
      dateSpan.textContent = studentData.fechaHora || 'No registrado';
    }

    function initializeStudentForm() {
      const dateInput = document.getElementById('studentDate');
      const timeInput = document.getElementById('studentTime');
      if (!dateInput || !timeInput) return;
      const now = new Date();
      dateInput.value = now.toLocaleDateString('es-CO');
      timeInput.value = now.toLocaleTimeString('es-CO');
    }

    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      const mm = m < 10 ? '0' + m : '' + m;
      const ss = s < 10 ? '0' + s : '' + s;
      return mm + ':' + ss;
    }

    function updateTimerDisplay() {
      const el = document.getElementById('timerDisplay');
      if (!el) return;
      el.textContent = formatTime(testTimerSeconds);
    }

    function startTestTimer() {
      if (testTimerStarted) return;
      testTimerStarted = true;
      testTimerSeconds = 0;
      updateTimerDisplay();
      testTimerInterval = setInterval(() => {
        testTimerSeconds++;
        updateTimerDisplay();
      }, 1000);
    }

    function stopTestTimer() {
      if (testTimerInterval) {
        clearInterval(testTimerInterval);
        testTimerInterval = null;
      }
    }

    const navButtons = document.querySelectorAll('.nav-button');
    const sections = document.querySelectorAll('.section');

    function goToNextLevel(currentLevel) {
      // Mapa actualizado con nivel0
      const nextMap = { nivel0: 'nivel1', nivel1: 'nivel2', nivel2: 'nivel3', nivel3: 'test' };
      const nextId = nextMap[currentLevel];
      if (!nextId) return;

      sections.forEach(sec => {
        sec.classList.toggle('visible', sec.id === nextId);
      });
      navButtons.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.section === nextId);
      });

      if (nextId === 'test') {
        updateStudentSummary();
        startTestTimer();
      }

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Navegaci√≥n
    navButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const target = btn.dataset.section;
        sections.forEach(sec => {
          sec.classList.toggle('visible', sec.id === target);
        });
        navButtons.forEach(b => b.classList.toggle('active', b === btn));

        if (target === 'test') {
          updateStudentSummary();
          startTestTimer();
        }
      });
    });

    // Botones de marcar nivel completado
    document.querySelectorAll('[data-mark-level]').forEach(btn => {
      btn.addEventListener('click', () => {
        const level = btn.dataset.markLevel;
        if (!canCompleteLevel(level)) {
          alert('Para marcar este nivel como completado, primero debe responder correctamente todos los mini-ejercicios de ese nivel.');
          return;
        }
        completedLevels[level] = true;
        btn.disabled = true;
        btn.textContent = 'Nivel marcado como completado ‚úÖ';
        updateProgressBar();

        if (level === 'nivel0' || level === 'nivel1' || level === 'nivel2' || level === 'nivel3') {
          goToNextLevel(level);
        }
      });
    });

    // Modo lectura f√°cil
    const toggleEasyModeBtn = document.getElementById('toggleEasyMode');
    toggleEasyModeBtn.addEventListener('click', () => {
      document.body.classList.toggle('easy-reading');
      const isEasy = document.body.classList.contains('easy-reading');
      toggleEasyModeBtn.textContent = 'Modo lectura f√°cil: ' + (isEasy ? 'encendido' : 'apagado');
    });

    // Modo oscuro / claro
    const toggleThemeBtn = document.getElementById('toggleTheme');
    toggleThemeBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark-theme');
      const isDark = document.body.classList.contains('dark-theme');
      toggleThemeBtn.textContent = 'Tema: ' + (isDark ? 'oscuro' : 'claro');
    });

    // Lectura en voz alta
    function speakText(elementId) {
      const el = document.getElementById(elementId);
      if (!el) return;
      if (!('speechSynthesis' in window)) {
        alert('La lectura en voz alta no es compatible con este navegador.');
        return;
      }
      window.speechSynthesis.cancel();
      const text = el.innerText;
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'es-ES';
      window.speechSynthesis.speak(utterance);
    }

    document.querySelectorAll('[data-read]').forEach(btn => {
      btn.addEventListener('click', () => {
        speakText(btn.dataset.read);
      });
    });

    // Guardar datos de la persona
    const saveStudentBtn = document.getElementById('saveStudentData');
    const studentFeedback = document.getElementById('studentFeedback');
    saveStudentBtn.addEventListener('click', () => {
      const nameInput = document.getElementById('studentName');
      const roleInput = document.getElementById('studentRole');
      const gradeInput = document.getElementById('studentGrade');
      const dateInput = document.getElementById('studentDate');
      const timeInput = document.getElementById('studentTime');

      const nombre = nameInput.value.trim();
      const rol = roleInput.value.trim();
      const grado = gradeInput.value.trim();

      if (!nombre) {
        studentFeedback.textContent = 'Por favor diligencie al menos el nombre.';
        studentFeedback.className = 'small-text text-warning';
        return;
      }

      studentData.nombre = nombre;
      studentData.rol = rol || 'Sin especificar';
      studentData.grado = grado || 'Sin especificar';
      studentData.fechaHora = (dateInput.value || '') + ' ' + (timeInput.value || '');

      studentFeedback.textContent = 'Datos guardados. Se mostrar√°n en el test final.';
      studentFeedback.className = 'small-text text-success';
      updateStudentSummary();
    });

    // Mini-ejercicios
    function handleMiniExercise(radioName, correctValue, feedbackId, levelKey, exerciseKey) {
      const selected = document.querySelector(`input[name="${radioName}"]:checked`);
      const feedbackEl = document.getElementById(feedbackId);
      if (!feedbackEl) return;

      if (!selected) {
        feedbackEl.textContent = 'Primero debe escoger una opci√≥n.';
        feedbackEl.className = 'feedback text-warning';
        if (levelKey && exerciseKey) miniExerciseState[levelKey][exerciseKey] = false;
        return;
      }

      if (selected.value === correctValue) {
        feedbackEl.textContent = '¬°Correcto! La respuesta coincide con la situaci√≥n del problema.';
        feedbackEl.className = 'feedback text-success';
        if (levelKey && exerciseKey) miniExerciseState[levelKey][exerciseKey] = true;
      } else {
        feedbackEl.textContent = 'No es correcto. Revise la explicaci√≥n del nivel y vuelva a intentarlo.';
        feedbackEl.className = 'feedback text-error';
        if (levelKey && exerciseKey) miniExerciseState[levelKey][exerciseKey] = false;
      }
    }

    document.getElementById('btn-n1-ex1').addEventListener('click', () => {
      handleMiniExercise('n1q1', 'c', 'n1ex1Feedback', 'nivel1', 'ex1');
    });
    document.getElementById('btn-n1-ex2').addEventListener('click', () => {
      handleMiniExercise('n1q2', 'b', 'n1ex2Feedback', 'nivel1', 'ex2');
    });
    document.getElementById('btn-n2-ex1').addEventListener('click', () => {
      handleMiniExercise('n2q1', 'b', 'n2ex1Feedback', 'nivel2', 'ex1');
    });
    document.getElementById('btn-n2-ex2').addEventListener('click', () => {
      handleMiniExercise('n2q2', 'b', 'n2ex2Feedback', 'nivel2', 'ex2');
    });
    document.getElementById('btn-n3-ex1').addEventListener('click', () => {
      handleMiniExercise('n3q1', 'b', 'n3ex1Feedback', 'nivel3', 'ex1');
    });
    document.getElementById('btn-n3-ex2').addEventListener('click', () => {
      handleMiniExercise('n3q2', 'c', 'n3ex2Feedback', 'nivel3', 'ex2');
    });

    // Banco de respuestas
    const quizAnswers = {
      q1: { correct: 'c', explanation: '3/2 son tres mitades de canasta...' },
      q2: { correct: 'b', explanation: 'Dos canastas y media es 2 1/2...' },
      q3: { correct: 'c', explanation: 'Una hora tiene 60 minutos. 3/4 √ó 60 = 45 minutos.' },
      q4: { correct: 'b', explanation: 'Grupo B revisa cada 15 min, es decir, m√°s veces.' },
      q5: { correct: 'b', explanation: '20/300 se simplifica a 1/15...' },
      q6: { correct: 'c', explanation: 'Un kilo dividido en 4 partes iguales deja 1/4...' },
      q7: { correct: 'c', explanation: '1 1/2 = 3/2.' },
      q8: { correct: 'b', explanation: 'El 4 es el denominador.' },
      q9: { correct: 'b', explanation: '7/4 = 1 3/4.' },
      q10: { correct: 'c', explanation: '3 1/4 = 13/4.' },
      q11: { correct: 'b', explanation: '3/2 (1.5) es mayor que 5/4 (1.25).' },
      q12: { correct: 'd', explanation: '1.5 horas = 90 minutos.' },
      q13: { correct: 'c', explanation: '1/3 de 60 = 20.' },
      q14: { correct: 'a', explanation: '2/3 (40min) > 3/5 (36min).' },
      q15: { correct: 'c', explanation: 'Ambas son 1/15.' },
      q16: { correct: 'b', explanation: '25g/300g es la mayor concentraci√≥n.' },
      q17: { correct: 'b', explanation: '3 veces 1/4 = 3/4.' },
      q18: { correct: 'd', explanation: '1 dividido 5 = 1/5.' },
      q19: { correct: 'c', explanation: '2 / 0.5 = 4 bolsas.' },
      q20: { correct: 'c', explanation: '2 1/4 = 9/4.' },
      q21: { correct: 'c', explanation: '2/4 simplificado es 1/2.' },
      q22: { correct: 'b', explanation: '1/4 < 1/2 < 3/4.' },
      q23: { correct: 'b', explanation: '10 de 20 es la mitad (1/2).' },
      q24: { correct: 'a', explanation: 'Numerador = partes que se toman.' },
      q25: { correct: 'b', explanation: 'El resto es 2/3.' },
      q26: { correct: 'b', explanation: '1/4 es mayor que 1/5.' },
      q27: { correct: 'b', explanation: '2/4 simplificado es 1/2.' },
      q28: { correct: 'd', explanation: '3/4 = 0.75.' }
    };

    // Selecci√≥n aleatoria de preguntas
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function initRandomQuestions() {
      const questions = document.querySelectorAll('#quizForm .question');
      const allIds = Array.from(questions).map(q => q.dataset.qid);
      const NUM_TO_SHOW = 10;

      if (allIds.length <= NUM_TO_SHOW) {
        activeQuestionIds = allIds;
      } else {
        const shuffledIds = shuffle(allIds.slice());
        activeQuestionIds = shuffledIds.slice(0, NUM_TO_SHOW);
      }

      questions.forEach(q => {
        const id = q.dataset.qid;
        if (activeQuestionIds.includes(id)) {
          q.style.display = 'block';
        } else {
          q.style.display = 'none';
        }
      });
    }

    // Env√≠o del test
    const submitQuizBtn = document.getElementById('submitQuiz');
    const quizResultDiv = document.getElementById('quizResult');
    const sheetFeedbackDiv = document.getElementById('sheetFeedback');

    submitQuizBtn.addEventListener('click', () => {
      if (!studentData.nombre) {
        alert('Antes de enviar el test, registre al menos el Nombre en la pantalla de inicio.');
        return;
      }

      let score = 0;
      const total = activeQuestionIds.length || Object.keys(quizAnswers).length;
      
      // Objeto para guardar respuestas limpias ('a', 'b', etc.)
      const cleanAnswers = {};

      activeQuestionIds.forEach(qid => {
        const qa = quizAnswers[qid];
        if (!qa) return;
        
        const feedbackEl = document.getElementById('feedback-' + qid);
        const selected = document.querySelector(`input[name="${qid}"]:checked`);
        
        if (selected) {
           cleanAnswers[qid] = selected.value; // Guardar respuesta limpia
           const isCorrect = selected.value === qa.correct;
           if (isCorrect) score++;
           // Feedback visual local
           const correctInput = document.querySelector(`input[name="${qid}"][value="${qa.correct}"]`);
           const correctText = correctInput ? correctInput.parentElement.textContent.trim() : '';
           const mainMsg = isCorrect
             ? '<p class="text-success">¬°Correcto!</p>'
             : '<p class="text-error">No es correcto.</p>';

           if (feedbackEl) {
             feedbackEl.innerHTML =
               mainMsg +
               `<p class="small-text">${qa.explanation}</p>` +
               `<p class="small-text"><strong>Respuesta correcta:</strong> ${qa.correct.toUpperCase()}) ${correctText}</p>`;
           }
        } else {
           cleanAnswers[qid] = ""; // Sin respuesta
           if (feedbackEl) {
             feedbackEl.innerHTML =
               '<p class="text-warning">Esta pregunta no fue respondida.</p>' +
               `<p class="small-text">${qa.explanation}</p>`;
           }
        }
      });

      const percent = Math.round((score / total) * 100);
      stopTestTimer();
      updateTimerDisplay();
      
      const timeStr = formatTime(testTimerSeconds);

      quizResultDiv.innerHTML =
        `<p><strong>Datos del intento:</strong><br>` +
        `Nombre: ${studentData.nombre || 'No registrado'}<br>` +
        `Rol: ${studentData.rol || 'No registrado'}<br>` +
        `Grado/Grupo: ${studentData.grado || 'No registrado'}<br>` +
        `Fecha y hora: ${studentData.fechaHora || 'No registrado'}<br>` +
        `Tiempo del test: ${timeStr}</p>` +
        `<p><strong>Resultado:</strong> ${score} de ${total} preguntas correctas (${percent}%).</p>`;

      submitQuizBtn.disabled = true;
      submitQuizBtn.textContent = 'Procesando env√≠o...';

      // **********************************************
      // ENVIAR DATOS A GOOGLE SHEETS
      // **********************************************
      
      if (GOOGLE_SCRIPT_URL === "PEGAR_AQUI_TU_URL_DE_APPS_SCRIPT") {
        sheetFeedbackDiv.innerHTML = '<span class="text-error">Error: No se ha configurado la URL del Script.</span>';
        submitQuizBtn.textContent = 'Resultados locales mostrados';
        return;
      }

      const payload = {
        nombre: studentData.nombre,
        rol: studentData.rol,
        grado: studentData.grado,
        score: `${score}/${total} (${percent}%)`,
        time: timeStr,
        answers: cleanAnswers
      };

      fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors', // Importante para enviar sin esperar respuesta JSON
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      })
      .then(() => {
        sheetFeedbackDiv.innerHTML = '<span class="text-success">‚úÖ Respuestas guardadas en la nube correctamente.</span>';
        submitQuizBtn.textContent = 'Respuestas enviadas';
      })
      .catch(err => {
        console.error(err);
        sheetFeedbackDiv.innerHTML = '<span class="text-warning">‚ö†Ô∏è Hubo un problema de conexi√≥n al guardar en la nube, pero tus resultados locales son v√°lidos.</span>';
        submitQuizBtn.textContent = 'Respuestas mostradas';
      });

      completedLevels.test = true;
      updateProgressBar();
    });

    // Inicializaci√≥n general
    initializeStudentForm();
    updateStudentSummary();
    updateTimerDisplay();
    updateProgressBar();
    initRandomQuestions();
  </script>
</body>
</html>
